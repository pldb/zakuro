# 儀鳳暦

文武天皇2年1月1日（698/02/16）-天平宝字7年12月30日（764/02/06）

# 著者

[pldb](https://github.com/pldb)

# 前提

儀鳳暦は太陰太陽暦である

詳細は [太陰太陽暦](./section/lunisolar_calendar.md) に記載してある

# 計算

計算にあたって、暦共通の計算と、儀鳳暦固有の計算がある

暦共通の計算は前処理/後処理として説明する

その間に儀鳳暦固有の計算を説明することとする

## 共通前処理

詳細は [共通前処理](./section/common_pre_process.md) に記載してある

## 儀鳳暦固有の計算

計算手順を以下に示す

1. 11月定朔（補正後の月初日）を求める
    1. 対象の西暦年から前年冬至を求める
    2. 対象の西暦年から冬至の月齢を求める
    3. 前年冬至から11月経朔（補正前の月初日）を求める
    4. 二十四節気から太陽の運動の補正値を求める
    5. 月の進退から月の運動の補正値を求める
    6. 太陽・月の運動の補正値から11月定朔（補正後の月初日）を求める
2. 12月定朔（補正後の月初日）を求める
    1. 11月経朔を進めて12月経朔を求める
    2. 11月の二十四節気を進めて12月の二十四節気を求める
    3. 12月の二十四節気から太陽の運動の補正値を求める
    4. 11月の月の進退を進めて12月の月の進退を求める
    5. 12月の月の進退から月の運動の補正値を求める
    6. 太陽・月の運動の補正値から12月定朔（補正後の月初日）を求める

TODO: 2の扱い

1の計算方法は『日本暦日原典』p.516-520に依拠する

基本的に [宣明暦](./senmyou.md) と手順は変わらない

使用する定数の差分は [定数](./section/const.md) に記載してある

上記のうち、宣明暦との差分のみ記載する

### 二十四節気から太陽の運動の補正値を求める

「24気損益眺朒数」は次の通りである

|-|a（眺朒数の初日の値）|b（損益率初日の値）|c（一日ごとの差）|
|:----|:----|:----|:----|
|冬至（とうじ）|0.0|+3.9546|-0.0372|
|小寒（しょうかん）|+54.0|+3.4091|-0.0372|
|大寒（だいかん）|+100.0|+2.8636|-0.0372|
|立春（りっしゅん）|+138.0|+2.3181|+0.0372|
|雨水（うすい）|+176.0|+2.8636|+0.0372|
|啓蟄（けいちつ）|+222.0|+3.4091|+0.0372|
|春分（しゅんぶん）|+276.0|-3.7220|+0.0329|
|清明（せいめい）|+222.0|-3.2086|+0.0329|
|穀雨（こくう）|+176.0|-2.6952|+0.0329|
|立夏（りっか）|+138.0|-2.1818|-0.0329|
|小満（しょうまん）|+100.0|-2.6952|-0.0329|
|芒種（ぼうしゅ）|+54.0|-3.2086|-0.0329|
|夏至（げし）|0.0|-3.7220|+0.0329|
|小暑（しょうしょ）|-54.0|-3.2086|+0.0329|
|大暑（たいしょ）|-100.0|-2.6952|+0.0329|
|立秋（りっしゅう）|-138.0|-2.1818|-0.0329|
|処暑（しょしょ）|-176.0|-2.6952|-0.0329|
|白露（はくろ）|-222.0|-3.2086|-0.0329|
|秋分（しゅうぶん）|-276.0|+3.9546|-0.0372|
|寒露（かんろ）|-222.0|+3.4091|-0.0372|
|霜降（そうこう）|-176.0|+2.8636|-0.0372|
|立冬（りっとう）|-138.0|+2.3181|+0.0372|
|小雪（しょうせつ）|-100.0|+2.8636|+0.0372|
|大雪（たいせつ）|-54.0|+3.4091|+0.0372|

#### 月の進退から月の運動の補正値を求める

宣明暦とは異なり、次の表を用いる

|入暦|小余（下限）|小余（上限）|増減率|遅速積|備考|
|:----|:----|:----|:----|:----|:----|
|01日|0|1340|-134|0|-|
|02日|0|1340|-117|-134|-|
|03日|0|1340|-99|-251|-|
|04日|0|1340|-78|-350|-|
|05日|0|1340|-56|-428|-|
|06日|0|1340|-33|-484|-|
|07日|0|1191|-9|-517|-|
|07日|1191|1340|0|-526|-|
|08日|0|1340|+14|-526|-|
|09日|0|1340|+38|-512|-|
|10日|0|1340|+62|-474|-|
|11日|0|1340|+85|-412|-|
|12日|0|1340|+104|-327|-|
|13日|0|1340|+121|-223|-|
|14日|0|1042|+102|-102|-|
|14日|1042|1340|+29|0|-|
|15日|0|1340|+128|+29|-|
|16日|0|1340|+115|+157|-|
|17日|0|1340|+95|+272|-|
|18日|0|1340|+74|+367|-|
|19日|0|1340|+52|+441|-|
|20日|0|1340|+28|+493|-|
|21日|0|892|+4|+521|-|
|21日|892|1340|0|+525|-|
|22日|0|1340|-20|+525|-|
|23日|0|1340|-44|+505|-|
|24日|0|1340|-68|+461|-|
|25日|0|1340|-89|+393|-|
|26日|0|1340|-108|+304|-|
|27日|0|1340|-125|+196|-|
|28日|0|743.06|-71|+71|-|

小余の下限上限は宣明暦と同等である

具体的な算出方法については次の通りである

```
宣明暦の7日の小余は7465である。入暦は1始まりなので、0始まりで表現すると 6-7465 となる
6 * 8400（統法） + 7465（初益） = 57865
これを儀鳳暦に変えると、 57865 / 1340（総法） = 6 余り 1190.845238..
これを入暦の1始まりに置き換え、少数部を消すと 7-1190、これが7日目となる
同様の方法で14日と21日も求める
57865 * 2 = 115730 / 1340（総法） = 13 余り 1041.690476 = 14-1041
57865 * 3 = 173595 / 1340（総法） = 20 余り 892.5357143 = 21-892

28日は変日の範囲内743とした。
宣明暦では 進退 14-6529（1始まりなので実質13） * 2 = 27-4658
暦周 27-4658.19 に一致する。これを変日27-743.1と同等とみなした

ただし、次の計算結果により切り上げる
* 天平勝宝2年（750年）5月 により 1191
* 養老6年（722年） 6月 により 1042
* 天平13年（741年） 2月 により 743.06
```

TODO: 『歴代天文律暦等志彙編』による論拠を確認すること

宣明暦とは異なり進退の列がないが、それは無視して入暦だけを求めればよい

これは『日本暦日原典』の中で計算方法Aとされている

他の計算方法B,Cも掲載されているが、ここでは一旦割愛する

#### 11月の二十四節気を進めて12月の二十四節気を求める

「入気定日加減数」は次の通りである

|二十四節気|経過|
|:----|:----|
| 冬至（とうじ）・大雪（たいせつ） | 14 日 910 分 5 秒 |
| 小寒（しょうかん）・小雪（しょうせつ） | 14 日 1014 分 5 秒 |
| 大寒（だいかん）・立冬（りっとう） | 14 日 1118 分 5 秒 |
| 立春（りっしゅん）・霜降（そうこう） | 14 日 1118 分 5 秒 |
| 雨水（うすい）・寒露（かんろ） | 14 日 1014 分 5 秒 |
| 啓蟄（けいちつ）・秋分（しゅうぶん） | 14 日 910 分 5 秒 |
| 春分（しゅんぶん）・白露（はくろ） | 15 日 1014 分 5 秒 |
| 清明（せいめい）・処暑（しょしょ） | 15 日 910 分 5 秒 |
| 穀雨（こくう）・立秋（りっしゅう） | 15 日 806 分 5 秒 |
| 立夏（りっか）・大暑（たいしょ） | 15 日 806 分 5 秒 |
| 小満（しょうまん）・小暑（しょうしょ） | 15 日 910 分 5 秒 |
| 芒種（ぼうしゅ）・夏至（げし） | 15 日 1014 分 5 秒 |

## 共通後処理

詳細は [共通後処理](./section/common_post_process.md) に記載してある

# 結語

暦共通・儀鳳暦の暦算は以上である

# 参考文献

* 内田　正男『日本暦日原典』雄山閣出版 1975(1975)
