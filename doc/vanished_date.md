# 滅日

没日を端的に説明すると、1朔望月（29.5..日）を30日で表わすために、一定の法則で `不足した日` として配置された日である

経朔（平均値で求めた月初日）をもとに計算を行う

## 計算
### 宣明暦
「長慶宣明暦算法」に従う

下記は該当箇所の引用と、それに対応する計算を示している

```
◯滅日ヲ求ルノ術
```

```
経朔之小余朔虚分ノ三千九百四十三ヨリ巳下ハ者之ヲ置キテ三十ヲ以テ之ヲ乗シ朔虚分ヲ以テ之ヲ除シ商ヲ以テ日ト為ス経朔ノ大余ヲ加フ甲子ヨリ命スル事右ノ如シ
```

* 滅日あり
  * 経朔の小余 < 3943
* 計算方法
  * (経朔の小余 * 30) / 3943 = 大余（正数） ... A
  * (経朔の小余 * 30) % 3943 = 小余        ... B
* 滅余
  * (A + 経朔の大余) % 60 = 大余
  * B = 小余

```
第一段ノ経朔ノ小余ノ數三千九百四十三ヨリ少クハ滅日ヲ求メヨト云フナリ則チ己丑ノ十二月ノ小余三百二十アリコレ朔虚分ノ數ヨリ少キ故ニ滅日ヲ求ムコノ三百二十置キテ三十ヲ以テ乗スレハ九千六百トナルコレヲ朔虚分ノ三千九百四十三ニテワレハ商ニトナリ不盡一千七百一十四アリ此ノ商ニニ経朔ノ大余二十二ヲクワエテ滅日ノ大余二十四小余一千七百十四トナルモシ経朔ノ大余ヲ加エテ甲子ノ六十にミツレハコレヲ去モシ小余ニ三十ヲ乗ソモ朔虚分ノ數ニタラサル時ハ経朔ノ大余ヲ直ニ用ユヘシ支干ヲ付ルフツ子ノ如ク紀法ノ圖ニテモトムヘシ二十四ハ戊子ナリ
```

* 経朔: 大余22小余320
* 滅日あり
  * 320 < 3943
* 計算
  * 30 * 320 = 9600
  * 9600 / 3943 = 2
  * 9600 % 3943 = 1714
* 滅余
  * (2 + 22) % 60 = 24
  * 1714

```
大余ニ二　小余ニ三千五百九十一
```

* 大余2小余3591

```
滅日ノ大小余ニ此ノ如ク加フレハ其次ノ滅日ノ大小余トナルモシクワエテ大余甲子ノ六十ニナレハ減去ス又小余朔虚分ノ三千九百四十三ニナレハ減去シテ大余三ヲ加フヘシサテ滅日ノアル月ハ経朔ノ小余朔虚分ノ數ヨリ以下ノ處ナリ
```

* 次の滅余
  * (小余1714 + 小余3591) % 3943 = 1362
  * (大余24 + 大余2 + 繰り上げ1) % 60 = 27

## 大衍暦
『歴代天文律暦等志彙編　七』に従う

### 本文

```
推滅日　以有滅之朔経小餘, 減大衍通法。餘, 倍参伍乗之, 用減滅法。餘, 満朔虚分, 為日。不満, 為滅餘。命起経朔初日算外, 即合朔後滅日也。凡経朔小餘不満朔虚分者, 為有滅之朔。
```
p.2056

```
大衍通法:三千四十。
四象之策:二十九:餘, 一千六百一十三。
```
p.2055-2056

### 定数
計算方法は宣明暦と変わらない。定数のみ取りだす

#### 朔虚分

本文中に言及はないが、宣明暦と変わらないと見て良い

`理想の月日数` (30) * `大衍通法` (3040) - ( `四象之策` (29 * 3040 + 1613) ) = 1427

#### 小余倍率

`倍参伍` (2 * 3 * 5) = 30
